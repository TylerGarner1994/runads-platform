<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RunAds - Landing Page & Ad Generation Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
}
body{
font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
background-color:#f9fafb;
color:#1f2937;
}
.layout{
display:flex;
height:100vh;
}
.sidebar{
width:280px;
background-color:#1a2332;
color:white;
padding:0;
display:flex;
flex-direction:column;
border-right:1px solid #374151;
overflow-y:auto;
}
.sidebar-logo{
padding:24px 20px;
font-size:24px;
font-weight:700;
letter-spacing:-0.5px;
border-bottom:1px solid #2d3748;
}
.sidebar-section{
padding:16px 0;
}
.sidebar-section-title{
padding:12px 20px;
font-size:11px;
font-weight:600;
text-transform:uppercase;
letter-spacing:0.5px;
color:#9ca3af;
}
.sidebar-item{
padding:12px 20px;
cursor:pointer;
display:flex;
align-items:center;
gap:12px;
font-size:14px;
transition:all 0.2s ease;
border-left:3px solid transparent;
}
.sidebar-item:hover{
background-color:#2d3748;
}
.sidebar-item.active{
background-color:#2563eb;
border-left-color:#2563eb;
}
.sidebar-item-icon{
font-size:18px;
min-width:24px;
}
.sidebar-footer{
margin-top:auto;
padding:16px 20px;
border-top:1px solid #2d3748;
font-size:12px;
color:#9ca3af;
text-align:center;
}
.main-content{
flex:1;
display:flex;
flex-direction:column;
overflow:hidden;
}
.header{
background-color:#ffffff;
border-bottom:1px solid #e5e7eb;
padding:20px 32px;
display:flex;
justify-content:space-between;
align-items:center;
}
.header-title{
font-size:28px;
font-weight:700;
}
.header-actions{
display:flex;
gap:12px;
align-items:center;
}
.content-area{
flex:1;
overflow-y:auto;
padding:32px;
}
.btn{
padding:10px 16px;
border-radius:8px;
font-size:14px;
font-weight:500;
border:none;
cursor:pointer;
transition:all 0.2s ease;
display:inline-flex;
align-items:center;
gap:8px;
}
.btn-primary{
background-color:#2563eb;
color:white;
}
.btn-primary:hover{
background-color:#1d4ed8;
}
.btn-secondary{
background-color:#f3f4f6;
color:#1f2937;
border:1px solid #e5e7eb;
}
.btn-secondary:hover{
background-color:#e5e7eb;
}
.btn-danger{
background-color:#ef4444;
color:white;
}
.btn-danger:hover{
background-color:#dc2626;
}
.btn-small{
padding:6px 12px;
font-size:13px;
}
.btn-icon{
padding:8px;
font-size:16px;
background:none;
border:none;
cursor:pointer;
color:#6b7280;
transition:color 0.2s ease;
}
.btn-icon:hover{
color:#2563eb;
}
.stats-grid{
display:grid;
grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
gap:20px;
margin-bottom:32px;
}
.stat-card{
background-color:#ffffff;
border:1px solid #e5e7eb;
border-radius:12px;
padding:20px;
}
.stat-label{
font-size:12px;
font-weight:600;
text-transform:uppercase;
color:#6b7280;
margin-bottom:8px;
letter-spacing:0.5px;
}
.stat-value{
font-size:32px;
font-weight:700;
color:#1f2937;
}
.stat-change{
font-size:12px;
color:#10b981;
margin-top:8px;
}
.table-container{
background-color:#ffffff;
border:1px solid #e5e7eb;
border-radius:12px;
overflow:hidden;
}
table{
width:100%;
border-collapse:collapse;
}
thead{
background-color:#f9fafb;
border-bottom:1px solid #e5e7eb;
}
th{
padding:12px 16px;
text-align:left;
font-size:12px;
font-weight:600;
text-transform:uppercase;
color:#6b7280;
letter-spacing:0.5px;
}
td{
padding:14px 16px;
border-bottom:1px solid #f3f4f6;
font-size:14px;
}
tbody tr:hover{
background-color:#f9fafb;
}
tbody tr:last-child td{
border-bottom:none;
}
.badge{
display:inline-block;
padding:4px 12px;
border-radius:20px;
font-size:12px;
font-weight:500;
}
.badge-success{
background-color:#d1fae5;
color:#065f46;
}
.badge-gray{
background-color:#f3f4f6;
color:#374151;
}
.badge-blue{
background-color:#dbeafe;
color:#1e40af;
}
.form-group{
margin-bottom:16px;
}
label{
display:block;
font-size:14px;
font-weight:500;
margin-bottom:6px;
color:#1f2937;
}
input[type="text"],
input[type="email"],
input[type="number"],
input[type="url"],
textarea,
select{
width:100%;
padding:10px 12px;
border:1px solid #e5e7eb;
border-radius:8px;
font-size:14px;
font-family:inherit;
transition:border-color 0.2s ease;
}
input[type="text"]:focus,
input[type="email"]:focus,
input[type="number"]:focus,
input[type="url"]:focus,
textarea:focus,
select:focus{
outline:none;
border-color:#2563eb;
box-shadow:0 0 0 3px rgba(37, 99, 235, 0.1);
}
textarea{
resize:vertical;
min-height:100px;
}
.modal-overlay{
display:none;
position:fixed;
top:0;
left:0;
right:0;
bottom:0;
background-color:rgba(0, 0, 0, 0.5);
z-index:1000;
align-items:center;
justify-content:center;
}
.modal-overlay.active{
display:flex;
}
.modal{
background-color:#ffffff;
border-radius:12px;
box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1);
max-width:900px;
width:90%;
max-height:90vh;
overflow-y:auto;
}
.modal-header{
padding:24px;
border-bottom:1px solid #e5e7eb;
display:flex;
justify-content:space-between;
align-items:center;
}
.modal-header-title{
font-size:20px;
font-weight:700;
}
.modal-close{
background:none;
border:none;
font-size:24px;
cursor:pointer;
color:#6b7280;
}
.modal-body{
padding:24px;
}
.modal-footer{
padding:24px;
border-top:1px solid #e5e7eb;
display:flex;
justify-content:flex-end;
gap:12px;
}
.cards-grid{
display:grid;
grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));
gap:16px;
margin-bottom:24px;
}
.card-option{
background-color:#ffffff;
border:2px solid #e5e7eb;
border-radius:12px;
padding:20px;
text-align:center;
cursor:pointer;
transition:all 0.2s ease;
}
.card-option:hover{
border-color:#2563eb;
box-shadow:0 4px 12px rgba(37, 99, 235, 0.1);
}
.card-option.selected{
border-color:#2563eb;
background-color:#eff6ff;
}
.card-option-icon{
font-size:32px;
margin-bottom:12px;
}
.card-option-title{
font-size:15px;
font-weight:600;
margin-bottom:4px;
}
.card-option-desc{
font-size:12px;
color:#6b7280;
}
.tabs{
display:flex;
gap:0;
border-bottom:1px solid #e5e7eb;
margin-bottom:24px;
}
.tab{
padding:12px 16px;
cursor:pointer;
font-size:14px;
font-weight:500;
color:#6b7280;
border-bottom:2px solid transparent;
transition:all 0.2s ease;
}
.tab:hover{
color:#1f2937;
}
.tab.active{
color:#2563eb;
border-bottom-color:#2563eb;
}
.tab-content{
display:none;
}
.tab-content.active{
display:block;
}
.loading{
display:inline-block;
width:20px;
height:20px;
border:3px solid #e5e7eb;
border-top-color:#2563eb;
border-radius:50%;
animation:spin 0.8s linear infinite;
}
.pipeline-step{
display:flex;
align-items:center;
gap:12px;
padding:8px 12px;
opacity:0.5;
transition:all 0.3s ease;
}
.pipeline-step .step-icon{font-size:18px;}
.pipeline-step .step-label{flex:1;font-size:14px;font-weight:500;}
.pipeline-step .step-status{font-size:13px;color:#666;min-width:80px;text-align:right;
}
@keyframes spin{
to{transform:rotate(360deg);}
}
.alert{
padding:12px 16px;
border-radius:8px;
margin-bottom:16px;
font-size:14px;
}
.alert-success{
background-color:#d1fae5;
color:#065f46;
border:1px solid #a7f3d0;
}
.alert-error{
background-color:#fee2e2;
color:#991b1b;
border:1px solid #fecaca;
}
.two-column{
display:grid;
grid-template-columns:1fr 1fr;
gap:20px;
}
.three-column{
display:grid;
grid-template-columns:repeat(3, 1fr);
gap:16px;
}
.color-input-group{
display:flex;
align-items:center;
gap:8px;
}
.color-input-group input[type="color"]{
width:50px;
height:40px;
border:1px solid #e5e7eb;
border-radius:8px;
cursor:pointer;
}
.color-input-group input[type="text"]{
flex:1;
}
.hidden{
display:none !important;
}
@media (max-width:1024px){
.sidebar{
width:240px;
}
.stats-grid{
grid-template-columns:repeat(2, 1fr);
}
.two-column{
grid-template-columns:1fr;
}
}
@media (max-width:768px){
.layout{
flex-direction:column;
}
.sidebar{
width:100%;
height:auto;
max-height:60px;
flex-direction:row;
align-items:center;
padding:0 20px;
}
.sidebar-logo{
padding:0;
border:none;
}
.sidebar-section{
display:none;
}
.sidebar-footer{
display:none;
}
.header{
padding:16px;
}
.content-area{
padding:16px;
}
.stats-grid{
grid-template-columns:1fr;
}
.modal{
width:95%;
}
}
.split-view{
display:grid;
grid-template-columns:1fr 1fr;
gap:16px;
height:500px;
}
.split-pane{
display:flex;
flex-direction:column;
border:1px solid #e5e7eb;
border-radius:8px;
overflow:hidden;
}
.split-pane-header{
padding:12px 16px;
border-bottom:1px solid #e5e7eb;
background-color:#f9fafb;
font-weight:500;
font-size:13px;
}
.split-pane-content{
flex:1;
overflow:hidden;
}
textarea.code-editor{
width:100%;
height:100%;
padding:12px;
border:none;
font-family:'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
font-size:12px;
resize:none;
}
iframe.preview{
width:100%;
height:100%;
border:none;
}
.toolbar{
display:flex;
gap:4px;
padding:12px;
border-bottom:1px solid #e5e7eb;
background-color:#f9fafb;
flex-wrap:wrap;
}
.toolbar-group{
display:flex;
gap:4px;
padding-right:8px;
border-right:1px solid #e5e7eb;
}
.toolbar-group:last-child{
border-right:none;
}
.chart-bar{
display:flex;
align-items:flex-end;
gap:8px;
height:200px;
margin-bottom:16px;
}
.chart-bar-item{
flex:1;
display:flex;
flex-direction:column;
align-items:center;
gap:8px;
}
.chart-bar-value{
background-color:#2563eb;
border-radius:4px 4px 0 0;
width:100%;
transition:all 0.2s ease;
}
.chart-bar-value:hover{
background-color:#1d4ed8;
}
.chart-bar-label{
font-size:12px;
color:#6b7280;
}
.client-detail{
background-color:#ffffff;
border-left:1px solid #e5e7eb;
overflow-y:auto;
}
.client-header{
padding:24px;
border-bottom:1px solid #e5e7eb;
}
.client-name{
font-size:22px;
font-weight:700;
margin-bottom:4px;
}
.client-website{
font-size:13px;
color:#6b7280;
}
.client-content{
padding:24px;
}
.multiselect-container{
display:grid;
grid-template-columns:repeat(auto-fill, minmax(120px, 1fr));
gap:8px;
margin-bottom:16px;
}
.multiselect-item{
display:flex;
align-items:center;
gap:8px;
padding:8px 12px;
border:1px solid #e5e7eb;
border-radius:6px;
cursor:pointer;
transition:all 0.2s ease;
background-color:#ffffff;
}
.multiselect-item:hover{
border-color:#2563eb;
}
.multiselect-item input[type="checkbox"]{
cursor:pointer;
}
.multiselect-item.selected{
border-color:#2563eb;
background-color:#eff6ff;
}
.flex-between{
display:flex;
justify-content:space-between;
align-items:center;
}
.flex-gap{
display:flex;
gap:8px;
align-items:center;
}
.action-buttons{
display:flex;
gap:8px;
align-items:center;
}
.action-button{
background:none;
border:none;
cursor:pointer;
font-size:16px;
padding:4px;
transition:transform 0.2s ease;
}
.action-button:hover{
transform:scale(1.2);
}
.steps{
display:flex;
justify-content:space-between;
margin-bottom:32px;
position:relative;
}
.steps::before{
content:'';
position:absolute;
top:20px;
left:0;
right:0;
height:2px;
background-color:#e5e7eb;
z-index:-1;
}
.step{
display:flex;
flex-direction:column;
align-items:center;
gap:8px;
}
.step-number{
width:40px;
height:40px;
background-color:#f3f4f6;
border:2px solid #e5e7eb;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
font-weight:600;
transition:all 0.2s ease;
}
.step.active .step-number{
background-color:#2563eb;
color:white;
border-color:#2563eb;
}
.step.completed .step-number{
background-color:#10b981;
border-color:#10b981;
color:white;
}
.step-label{
font-size:13px;
font-weight:500;
color:#6b7280;
}
.step.active .step-label{
color:#2563eb;
}
.chat-panel{
position:fixed;
right:0;
bottom:0;
width:400px;
height:500px;
background-color:#ffffff;
border:1px solid #e5e7eb;
border-top-left-radius:12px;
display:none;
flex-direction:column;
z-index:999;
box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1);
}
.chat-panel.active{
display:flex;
}
.chat-header{
padding:16px;
border-bottom:1px solid #e5e7eb;
display:flex;
justify-content:space-between;
align-items:center;
}
.chat-messages{
flex:1;
overflow-y:auto;
padding:16px;
display:flex;
flex-direction:column;
gap:12px;
}
.chat-message{
display:flex;
gap:8px;
font-size:13px;
line-height:1.4;
}
.chat-message.user{
justify-content:flex-end;
}
.chat-message-bubble{
max-width:70%;
padding:10px 12px;
border-radius:8px;
word-wrap:break-word;
}
.chat-message.assistant .chat-message-bubble{
background-color:#f3f4f6;
color:#1f2937;
}
.chat-message.user .chat-message-bubble{
background-color:#2563eb;
color:white;
}
.chat-input-area{
padding:12px;
border-top:1px solid #e5e7eb;
display:flex;
gap:8px;
}
.chat-input-area input{
flex:1;
padding:8px 12px;
border:1px solid #e5e7eb;
border-radius:6px;
font-size:13px;
}
.chat-input-area button{
padding:8px 12px;
background-color:#2563eb;
color:white;
border:none;
border-radius:6px;
cursor:pointer;
font-size:13px;
}
.text-center{
text-align:center;
}
.text-muted{
color:#6b7280;
}
.mb-4{
margin-bottom:16px;
}
.gap-2{
gap:8px;
}
.mt-4{
margin-top:16px;
}
</style>
</head>
<body>
<div class="layout">
<aside class="sidebar">
<div class="sidebar-logo">RUNADS</div>
<div class="sidebar-section">
<div class="sidebar-section-title">Main</div>
<div class="sidebar-item active" data-view="dashboard">
<span class="sidebar-item-icon">üìä</span>
<span>Dashboard</span>
</div>
<div class="sidebar-item" data-view="landing-pages">
<span class="sidebar-item-icon">üìÑ</span>
<span>Landing Pages</span>
</div>
</div>
<div class="sidebar-section">
<div class="sidebar-section-title">Clients</div>
<div class="sidebar-item" data-view="all-clients">
<span class="sidebar-item-icon">üë•</span>
<span>All Clients</span>
</div>
<div class="sidebar-item" data-view="add-client-form">
<span class="sidebar-item-icon">‚ûï</span>
<span>Add Client</span>
</div>
</div>
<div class="sidebar-section">
<div class="sidebar-section-title">Create</div>
<div class="sidebar-item" data-view="generate-page-modal">
<span class="sidebar-item-icon">‚ú®</span>
<span>Generate Page</span>
</div>
<div class="sidebar-item" data-view="import-html-modal">
<span class="sidebar-item-icon">‚ûï</span>
<span>Import HTML</span>
</div>
</div>
<div class="sidebar-section">
<div class="sidebar-section-title">Meta Ads</div>
<div class="sidebar-item" data-view="ad-generator">
<span class="sidebar-item-icon">üì¢</span>
<span>Ad Generator</span>
</div>
</div>
<div class="sidebar-section">
<div class="sidebar-section-title">Analytics</div>
<div class="sidebar-item" data-view="reports">
<span class="sidebar-item-icon">üìà</span>
<span>Reports</span>
</div>
<div class="sidebar-item" data-view="leads">
<span class="sidebar-item-icon">üë§</span>
<span>Leads</span>
</div>
</div>
<div class="sidebar-footer">
RunAds Team<br>Administrator
</div>
</aside>
<div class="main-content">
<header class="header">
<h1 class="header-title" id="pageTitle">Dashboard</h1>
<div class="header-actions" id="headerActions"></div>
</header>
<div class="content-area" id="contentArea"></div>
</div>
</div>
<div class="modal-overlay" id="generatePageModal">
<div class="modal">
<div class="modal-header">
<h2 class="modal-header-title">Generate Landing Page</h2>
<button class="modal-close" onclick="closeModal('generatePageModal')">‚úï</button>
</div>
<div class="modal-body">
<div style="margin-bottom:24px;">
<label style="margin-bottom:12px;display:block;font-weight:600;">Page Type</label>
<div class="cards-grid">
<div class="card-option" onclick="selectPageType(this, 'advertorial')">
<div class="card-option-icon">üì∞</div>
<div class="card-option-title">Advertorial</div>
<div class="card-option-desc">Editorial-style article</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'listicle')">
<div class="card-option-icon">üìã</div>
<div class="card-option-title">Listicle</div>
<div class="card-option-desc">List-based article</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'quiz')">
<div class="card-option-icon">‚ùì</div>
<div class="card-option-title">Quiz Funnel</div>
<div class="card-option-desc">Interactive quiz</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'vip-signup')">
<div class="card-option-icon">üëë</div>
<div class="card-option-title">VIP Signup</div>
<div class="card-option-desc">VIP email capture</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'calculator')">
<div class="card-option-icon">üßÆ</div>
<div class="card-option-title">Calculator</div>
<div class="card-option-desc">Interactive calculator</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'sales-letter')">
<div class="card-option-icon">üíå</div>
<div class="card-option-title">Sales Letter</div>
<div class="card-option-desc">Direct response letter</div>
</div>
<div class="card-option" onclick="selectPageType(this, 'sms-tips')">
<div class="card-option-icon">üì±</div>
<div class="card-option-title">SMS Tips</div>
<div class="card-option-desc">SMS lead magnet</div>
</div>
</div>
</div>
<div class="form-group">
<label>Product/Offer URL or Description</label>
<input type="text" id="generatePageUrl" placeholder="https://example.com or product description">
</div>
<div class="form-group">
<label>Target Audience</label>
<textarea id="generatePageAudience" placeholder="Describe your target audience..."></textarea>
</div>
<div class="two-column">
<div class="form-group">
<label>Tone & Style</label>
<select id="generatePageTone">
<option value="">Select tone...</option>
<option value="professional">Professional & Trustworthy</option>
<option value="conversational">Conversational & Friendly</option>
<option value="urgent">Urgent & Direct</option>
<option value="playful">Playful & Bold</option>
<option value="authoritative">Authoritative & Expert</option>
</select>
</div>
<div class="form-group">
<label>Client (Optional)</label>
<select id="generatePageClient">
<option value="">No client assigned</option>
</select>
</div>
</div>
</div>
<div id="pipelineProgress" style="display:none;padding:20px;">
<h3 style="margin-bottom:16px;font-size:16px;font-weight:600;">7-Step AI Generation Pipeline</h3>
<div id="pipelineSteps" style="display:flex;flex-direction:column;gap:8px;">
<div class="pipeline-step" data-step="research"><span class="step-icon">üîç</span><span class="step-label">Deep Research</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="brand"><span class="step-icon">üé®</span><span class="step-label">Brand Extraction</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="strategy"><span class="step-icon">üß†</span><span class="step-label">Page Strategy</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="copy"><span class="step-icon">‚úçÔ∏è</span><span class="step-label">Copy Generation</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="design"><span class="step-icon">üéØ</span><span class="step-label">Design Generation</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="factcheck"><span class="step-icon">‚úÖ</span><span class="step-label">Fact Checking</span><span class="step-status">Waiting</span></div>
<div class="pipeline-step" data-step="assembly"><span class="step-icon">üöÄ</span><span class="step-label">Final Assembly</span><span class="step-status">Waiting</span></div>
</div>
<div id="pipelineProgressBar" style="margin-top:16px;background:#e0e0e0;border-radius:8px;height:8px;overflow:hidden;">
<div id="pipelineProgressFill" style="width:0%;height:100%;background:linear-gradient(90deg,#2563eb,#7c3aed);border-radius:8px;transition:width 0.5s ease;"></div>
</div>
<div id="pipelineStatus" style="margin-top:8px;font-size:13px;color:#666;"></div>
<div id="pipelineCost" style="margin-top:4px;font-size:12px;color:#999;"></div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" id="generateCancelBtn" onclick="closeModal('generatePageModal')">Cancel</button>
<button class="btn btn-primary" id="generatePageBtn" onclick="generatePage()">
<span>Generate Page</span>
</button>
</div>
</div>
</div>
<div class="modal-overlay" id="importHtmlModal">
<div class="modal">
<div class="modal-header">
<h2 class="modal-header-title">Import HTML</h2>
<button class="modal-close" onclick="closeModal('importHtmlModal')">‚úï</button>
</div>
<div class="modal-body">
<div class="form-group">
<label>Page Name</label>
<input type="text" id="importPageName" placeholder="My Landing Page">
</div>
<div class="form-group">
<label>Client (Optional)</label>
<select id="importClient">
<option value="">No client assigned</option>
</select>
</div>
<div class="form-group">
<label>HTML Code</label>
<textarea id="importHtmlCode" placeholder="Paste your HTML code here..." style="min-height:300px;"></textarea>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="closeModal('importHtmlModal')">Cancel</button>
<button class="btn btn-primary" id="importHtmlBtn" onclick="importHtml()">Import & Deploy</button>
</div>
</div>
</div>
<div class="modal-overlay" id="editPageModal">
<div class="modal" style="max-width:1200px;">
<div class="modal-header">
<h2 class="modal-header-title">Edit Page HTML</h2>
<button class="modal-close" onclick="closeModal('editPageModal')">‚úï</button>
</div>
<div class="modal-body">
<div style="margin-bottom:16px;">
<div class="toolbar">
<div class="toolbar-group">
<button class="btn btn-icon" title="Bold"><strong>B</strong></button>
<button class="btn btn-icon" title="Italic"><em>I</em></button>
<button class="btn btn-icon" title="Heading">H1</button>
</div>
<div class="toolbar-group">
<button class="btn btn-icon" title="Link">üîó</button>
<button class="btn btn-icon" title="Image">üñºÔ∏è</button>
<button class="btn btn-icon" title="Color">üé®</button>
</div>
</div>
</div>
<div class="split-view">
<div class="split-pane">
<div class="split-pane-header">HTML Editor</div>
<div class="split-pane-content">
<textarea id="htmlEditorCode" class="code-editor"></textarea>
</div>
</div>
<div class="split-pane">
<div class="split-pane-header">Preview</div>
<div class="split-pane-content">
<iframe id="htmlEditorPreview" class="preview"></iframe>
</div>
</div>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" onclick="closeModal('editPageModal')">Cancel</button>
<button class="btn btn-primary" id="editPageSaveBtn" onclick="savePage()">Save & Deploy</button>
</div>
</div>
</div>
<div class="modal-overlay" id="pageAnalyticsModal">
<div class="modal">
<div class="modal-header">
<h2 class="modal-header-title">Page Analytics</h2>
<button class="modal-close" onclick="closeModal('pageAnalyticsModal')">‚úï</button>
</div>
<div class="modal-body">
<div style="margin-bottom:24px;">
<label style="margin-bottom:8px;display:block;">Time Period</label>
<div style="display:flex;gap:8px;">
<button class="btn btn-secondary btn-small" onclick="setAnalyticsPeriod('7d')">7 Days</button>
<button class="btn btn-secondary btn-small" onclick="setAnalyticsPeriod('30d')">30 Days</button>
<button class="btn btn-secondary btn-small" onclick="setAnalyticsPeriod('90d')">90 Days</button>
<button class="btn btn-secondary btn-small" onclick="setAnalyticsPeriod('all')">All Time</button>
</div>
</div>
<div style="margin-bottom:32px;">
<h3 style="margin-bottom:16px;font-size:16px;font-weight:600;">Views Over Time</h3>
<div class="chart-bar" id="viewsChart"></div>
</div>
<div style="margin-bottom:32px;">
<h3 style="margin-bottom:16px;font-size:16px;font-weight:600;">Leads Over Time</h3>
<div class="chart-bar" id="leadsChart"></div>
</div>
<div class="two-column">
<div>
<h3 style="margin-bottom:16px;font-size:16px;font-weight:600;">Top Traffic Sources</h3>
<table style="width:100%;font-size:13px;">
<thead>
<tr style="border-bottom:1px solid #e5e7eb;">
<th style="text-align:left;padding:8px 0;">Source</th>
<th style="text-align:right;padding:8px 0;">Visits</th>
</tr>
</thead>
<tbody id="trafficSourcesTable">
</tbody>
</table>
</div>
<div>
<h3 style="margin-bottom:16px;font-size:16px;font-weight:600;">Device Breakdown</h3>
<table style="width:100%;font-size:13px;">
<thead>
<tr style="border-bottom:1px solid #e5e7eb;">
<th style="text-align:left;padding:8px 0;">Device</th>
<th style="text-align:right;padding:8px 0;">%</th>
</tr>
</thead>
<tbody id="deviceTable">
<tr><td style="padding:8px 0;">Desktop</td><td style="text-align:right;">65%</td></tr>
<tr><td style="padding:8px 0;">Mobile</td><td style="text-align:right;">30%</td></tr>
<tr><td style="padding:8px 0;">Tablet</td><td style="text-align:right;">5%</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="chat-panel" id="chatPanel">
<div class="chat-header">
<span style="font-weight:600;">AI Assistant</span>
<button class="modal-close" onclick="toggleChatPanel()" style="padding:0;color:#6b7280;">‚úï</button>
</div>
<div class="chat-messages" id="chatMessages"></div>
<div class="chat-input-area">
<input type="text" id="chatInput" placeholder="Describe changes...">
<button onclick="sendChatMessage()">Send</button>
</div>
</div>
<script>
const app ={
currentView:'dashboard',
currentClient:null,
currentPage:null,
selectedPageType:null,
pages:[],
clients:[],
stats:{
totalPages:0,
livePages:0,
totalViews:0,
totalLeads:0
}
};
document.addEventListener('DOMContentLoaded', () =>{
setupEventListeners();
loadInitialData();
showView('dashboard');
});
function setupEventListeners(){
document.querySelectorAll('[data-view]').forEach(item =>{
item.addEventListener('click', () =>{
const view = item.getAttribute('data-view');
if (view === 'generate-page-modal'){
openModal('generatePageModal');
}else if (view === 'import-html-modal'){
openModal('importHtmlModal');
}else{
updateSidebarActive(item);
showView(view);
}
});
});
}
function updateSidebarActive(element){
document.querySelectorAll('.sidebar-item').forEach(item =>{
item.classList.remove('active');
});
element.classList.add('active');
}
function loadInitialData(){
loadPages();
loadClients();
loadStats();
loadClientsForSelects();
}
function refreshCurrentView(){
if(app.currentView){showView(app.currentView);}
}
function loadPages(){
fetch('/api/pages')
.then(res => res.json())
.then(data =>{
app.pages = data.pages || [];
refreshCurrentView();
})
.catch(err => console.error('Failed to load pages:', err));
}
function loadClients(){
fetch('/api/clients')
.then(res => res.json())
.then(data =>{
app.clients = data.clients || [];
loadClientsForSelects();
})
.catch(err => console.error('Failed to load clients:', err));
}
function loadStats(){
fetch('/api/stats')
.then(res => res.json())
.then(data =>{
app.stats = data;
refreshCurrentView();
})
.catch(err => console.error('Failed to load stats:', err));
}
function loadClientsForSelects(){
setTimeout(() =>{
const selects = document.querySelectorAll('#generatePageClient, #importClient');
selects.forEach(select =>{
select.innerHTML = '<option value="">No client assigned</option>';
app.clients.forEach(client =>{
const option = document.createElement('option');
option.value = client.id;
option.textContent = client.name;
select.appendChild(option);
});
});
}, 500);
}
function showView(viewName){
app.currentView = viewName;
const contentArea = document.getElementById('contentArea');
const headerTitle = document.getElementById('pageTitle');
const headerActions = document.getElementById('headerActions');
contentArea.innerHTML = '';
headerActions.innerHTML = '';
switch (viewName){
case 'dashboard':
headerTitle.textContent = 'Dashboard';
renderDashboard(contentArea, headerActions);
break;
case 'landing-pages':
headerTitle.textContent = 'Landing Pages';
renderLandingPages(contentArea, headerActions);
break;
case 'all-clients':
headerTitle.textContent = 'All Clients';
renderAllClients(contentArea, headerActions);
break;
case 'add-client-form':
headerTitle.textContent = 'Add Client';
renderAddClientForm(contentArea);
break;
case 'ad-generator':
headerTitle.textContent = 'Ad Generator';
renderAdGenerator(contentArea);
break;
case 'reports':
headerTitle.textContent = 'Reports';
renderReports(contentArea);
break;
case 'leads':
headerTitle.textContent = 'Leads';
renderLeads(contentArea, headerActions);
break;
default:
headerTitle.textContent = 'Dashboard';
renderDashboard(contentArea, headerActions);
}
}
function renderDashboard(container, headerActions){
headerActions.innerHTML = `<button class="btn btn-primary" onclick="openModal('generatePageModal')">+ New Page</button>`;
const html = `
<div class="stats-grid">
<div class="stat-card">
<div class="stat-label">Total Pages</div>
<div class="stat-value">${app.stats.totalPages || 0}</div>
</div>
<div class="stat-card">
<div class="stat-label">Live Pages</div>
<div class="stat-value">${app.stats.livePages || 0}</div>
</div>
<div class="stat-card">
<div class="stat-label">Total Views</div>
<div class="stat-value">${(app.stats.totalViews || 0).toLocaleString()}</div>
<div class="stat-change">+12% vs last month</div>
</div>
<div class="stat-card">
<div class="stat-label">Total Leads</div>
<div class="stat-value">${(app.stats.totalLeads || 0).toLocaleString()}</div>
<div class="stat-change">+8% vs last month</div>
</div>
</div>
<div style="margin-bottom:24px;display:flex;justify-content:space-between;align-items:center;">
<h2 style="font-size:20px;font-weight:700;">Landing Pages</h2>
<button class="btn btn-secondary" onclick="loadPages();renderDashboard(document.getElementById('contentArea'), document.getElementById('headerActions'))">üîÑ Refresh</button>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>Name</th>
<th>Client</th>
<th>Status</th>
<th>Views</th>
<th>Leads</th>
<th>Conv.</th>
<th>URL</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="pagesTable">
</tbody>
</table>
</div>
`;
container.innerHTML = html;
renderPagesTable();
}
function renderPagesTable(){
const tbody = document.getElementById('pagesTable');
tbody.innerHTML = '';
if (app.pages.length === 0){
tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:32px;color:#6b7280;">No pages yet. Create one to get started!</td></tr>';
return;
}
app.pages.forEach(page =>{
const conv = page.views > 0 ? ((page.leads / page.views) * 100).toFixed(1):'0';
const row = document.createElement('tr');
row.innerHTML = `
<td><strong>${page.name}</strong></td>
<td>${page.clientName || '‚Äî'}</td>
<td><span class="badge ${page.status === 'live' ? 'badge-success':'badge-gray'}">${page.status === 'live' ? 'Live':'Draft'}</span></td>
<td>${page.views || 0}</td>
<td>${page.leads || 0}</td>
<td>${conv}%</td>
<td><a href="${page.url}" target="_blank" style="color:#2563eb;text-decoration:none;">View ‚Üí</a></td>
<td>
<div class="action-buttons">
<button class="action-button" title="Visual Edit" onclick="editPage('${page.id}')">üé®</button>
<button class="action-button" title="Analytics" onclick="viewPageAnalytics('${page.id}')">üìä</button>
<button class="action-button" title="A/B Variants" onclick="generateVariants('${page.id}')">üîÄ</button>
<button class="action-button" title="Edit HTML" onclick="openHtmlEditor('${page.id}')">‚úèÔ∏è</button>
<button class="action-button" title="Delete" onclick="deletePage('${page.id}')">üóëÔ∏è</button>
</div>
</td>
`;
tbody.appendChild(row);
});
}
function renderLandingPages(container, headerActions){
headerActions.innerHTML = `<button class="btn btn-primary" onclick="openModal('generatePageModal')">+ New Page</button>`;
renderDashboard(container, headerActions);
}
function renderAllClients(container, headerActions){
headerActions.innerHTML = `<button class="btn btn-primary" onclick="showView('add-client-form')">+ Add Client</button>`;
const html = `
<div class="table-container">
<table>
<thead>
<tr>
<th>Client Name</th>
<th>Website</th>
<th>Industry</th>
<th>Research Status</th>
<th>Created</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="clientsTable">
</tbody>
</table>
</div>
`;
container.innerHTML = html;
renderClientsTable();
}
function renderClientsTable(){
const tbody = document.getElementById('clientsTable');
tbody.innerHTML = '';
if (app.clients.length === 0){
tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:32px;color:#6b7280;">No clients yet. Add one to get started!</td></tr>';
return;
}
app.clients.forEach(client =>{
const row = document.createElement('tr');
row.innerHTML = `
<td><strong style="cursor:pointer;color:#2563eb;" onclick="viewClientDetail('${client.id}')">${client.name}</strong></td>
<td><a href="${client.website}" target="_blank" style="color:#2563eb;text-decoration:none;font-size:13px;">${client.website || '‚Äî'}</a></td>
<td><span class="badge badge-blue">${client.industry || 'Unknown'}</span></td>
<td><span class="badge ${client.researchStatus === 'complete' ? 'badge-success':'badge-gray'}">${client.researchStatus || 'Pending'}</span></td>
<td style="font-size:13px;color:#6b7280;">${new Date(client.createdAt).toLocaleDateString()}</td>
<td>
<button class="action-button" title="Delete" onclick="deleteClient('${client.id}')">üóëÔ∏è</button>
</td>
`;
tbody.appendChild(row);
});
}
function viewClientDetail(clientId){
const client = app.clients.find(c => c.id === clientId);
if (!client) return;
app.currentClient = client;
const contentArea = document.getElementById('contentArea');
fetch(`/api/clients/${clientId}`)
.then(res => res.json())
.then(data =>{
renderClientDetail(contentArea, data);
})
.catch(err => console.error('Failed to load client:', err));
}
function renderClientDetail(container, client){
const html = `
<div style="display:flex;gap:24px;">
<div style="flex:1;">
<button class="btn btn-secondary btn-small" style="margin-bottom:24px;" onclick="showView('all-clients')">‚Üê Back to Clients</button>
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;margin-bottom:24px;">
<h2 style="font-size:24px;font-weight:700;margin-bottom:4px;">${client.name}</h2>
<p style="color:#6b7280;font-size:14px;">${client.website || 'No website'}</p>
</div>
<div class="tabs">
<div class="tab active" onclick="switchClientTab(this, 'overview')">Overview</div>
<div class="tab" onclick="switchClientTab(this, 'brand-guide')">Brand Guide</div>
<div class="tab" onclick="switchClientTab(this, 'research')">Research</div>
<div class="tab" onclick="switchClientTab(this, 'verified-facts')">Verified Facts</div>
<div class="tab" onclick="switchClientTab(this, 'pages')">Pages</div>
</div>
<div id="clientTabs">
<div id="overview-tab" class="tab-content active">
<div class="stats-grid">
<div class="stat-card">
<div class="stat-label">Total Pages</div>
<div class="stat-value">${client.totalPages || 0}</div>
</div>
<div class="stat-card">
<div class="stat-label">Total Views</div>
<div class="stat-value">${(client.totalViews || 0).toLocaleString()}</div>
</div>
<div class="stat-card">
<div class="stat-label">Total Leads</div>
<div class="stat-value">${(client.totalLeads || 0).toLocaleString()}</div>
</div>
</div>
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;">
<h3 style="font-size:18px;font-weight:700;margin-bottom:16px;">Value Propositions</h3>
<ul style="list-style:none;padding:0;">
${(client.valuePropositions || []).map(vp => `<li style="padding:8px 0;border-bottom:1px solid #f3f4f6;">‚úì ${vp}</li>`).join('')}
</ul>
</div>
</div>
<div id="brand-guide-tab" class="tab-content hidden">
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;">
<h3 style="font-size:18px;font-weight:700;margin-bottom:24px;">Brand Colors</h3>
<div class="three-column" style="margin-bottom:32px;">
<div class="form-group">
<label>Primary Color</label>
<div class="color-input-group">
<input type="color" id="colorPrimary" value="${client.brandGuide?.primaryColor || '#2563eb'}">
<input type="text" value="${client.brandGuide?.primaryColor || '#2563eb'}" readonly style="flex:1;">
</div>
</div>
<div class="form-group">
<label>Secondary Color</label>
<div class="color-input-group">
<input type="color" id="colorSecondary" value="${client.brandGuide?.secondaryColor || '#10b981'}">
<input type="text" value="${client.brandGuide?.secondaryColor || '#10b981'}" readonly>
</div>
</div>
<div class="form-group">
<label>Accent Color</label>
<div class="color-input-group">
<input type="color" id="colorAccent" value="${client.brandGuide?.accentColor || '#f59e0b'}">
<input type="text" value="${client.brandGuide?.accentColor || '#f59e0b'}" readonly>
</div>
</div>
</div>
<h3 style="font-size:18px;font-weight:700;margin-bottom:24px;margin-top:32px;">Typography & Layout</h3>
<div class="two-column" style="margin-bottom:32px;">
<div class="form-group">
<label>Primary Font</label>
<select>
<option>Inter</option>
<option>Roboto</option>
<option>Playfair Display</option>
<option>Poppins</option>
</select>
</div>
<div class="form-group">
<label>Border Radius</label>
<select>
<option>4px (Sharp)</option>
<option>8px (Rounded)</option>
<option>12px (Smooth)</option>
<option>20px (Very Round)</option>
</select>
</div>
</div>
<button class="btn btn-primary" onclick="saveBrandGuide('${client.id}')">Save Brand Guide</button>
</div>
</div>
<div id="research-tab" class="tab-content hidden">
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;">
<div class="form-group">
<label>Company Name</label>
<input type="text" value="${client.companyName || ''}" readonly>
</div>
<div class="form-group">
<label>Industry</label>
<input type="text" value="${client.industry || ''}" readonly>
</div>
<div class="form-group">
<label>Tagline</label>
<input type="text" value="${client.tagline || ''}" readonly>
</div>
<div class="form-group">
<label>Brand Voice</label>
<input type="text" value="${client.brandVoice || ''}" readonly>
</div>
<div class="form-group">
<label>Products/Services</label>
<textarea readonly>${(client.products || []).join('\n')}</textarea>
</div>
</div>
</div>
<div id="verified-facts-tab" class="tab-content hidden">
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;">
<button class="btn btn-primary" style="margin-bottom:24px;">+ Add Fact</button>
<div id="factsList">
${(client.verifiedFacts || []).map(fact => `
<div style="padding:16px;border:1px solid #e5e7eb;border-radius:8px;margin-bottom:12px;">
<div style="font-weight:600;margin-bottom:4px;">${fact.claim}</div>
<div style="font-size:13px;color:#6b7280;">${fact.source}</div>
<span class="badge badge-gray" style="margin-top:8px;">${fact.category}</span>
</div>
`).join('')}
</div>
</div>
</div>
<div id="pages-tab" class="tab-content hidden">
<div class="table-container">
<table>
<thead>
<tr>
<th>Page Name</th>
<th>Status</th>
<th>Views</th>
<th>Leads</th>
</tr>
</thead>
<tbody id="clientPagesTable">
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
`;
container.innerHTML = html;
renderClientPages(client.id);
}
function switchClientTab(element, tabName){
document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
element.classList.add('active');
document.getElementById(tabName + '-tab').classList.remove('hidden');
}
function renderClientPages(clientId){
const tbody = document.getElementById('clientPagesTable');
const clientPages = app.pages.filter(p => p.clientId === clientId);
tbody.innerHTML = '';
if (clientPages.length === 0){
tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;padding:32px;color:#6b7280;">No pages for this client yet</td></tr>';
return;
}
clientPages.forEach(page =>{
const row = document.createElement('tr');
row.innerHTML = `
<td><strong>${page.name}</strong></td>
<td><span class="badge ${page.status === 'live' ? 'badge-success':'badge-gray'}">${page.status === 'live' ? 'Live':'Draft'}</span></td>
<td>${page.views || 0}</td>
<td>${page.leads || 0}</td>
`;
tbody.appendChild(row);
});
}
function renderAddClientForm(container){
const html = `
<div style="max-width:600px;">
<div class="form-group">
<label>Client Name *</label>
<input type="text" id="clientName" placeholder="Your Client Name">
</div>
<div class="form-group">
<label>Website</label>
<input type="url" id="clientWebsite" placeholder="https://example.com">
</div>
<div class="form-group">
<label>Industry</label>
<input type="text" id="clientIndustry" placeholder="e.g., Technology, Health, Finance">
</div>
<div class="form-group">
<label>Tagline</label>
<input type="text" id="clientTagline" placeholder="Company tagline">
</div>
<div class="form-group">
<label>Value Propositions</label>
<textarea id="clientValueProps" placeholder="One per line"></textarea>
</div>
<div style="display:flex;gap:12px;">
<button class="btn btn-primary" onclick="addClient()">Create Client</button>
<button class="btn btn-secondary" onclick="showView('all-clients')">Cancel</button>
</div>
</div>
`;
container.innerHTML = html;
}
function addClient(){
const clientData ={
name:document.getElementById('clientName').value,
website:document.getElementById('clientWebsite').value,
industry:document.getElementById('clientIndustry').value,
tagline:document.getElementById('clientTagline').value,
valuePropositions:document.getElementById('clientValueProps').value.split('\n').filter(v => v.trim())
};
if (!clientData.name){
alert('Client name is required');
return;
}
fetch('/api/clients',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify(clientData)
})
.then(res => res.json())
.then(data =>{
loadClients();
loadClientsForSelects();
showView('all-clients');
alert('Client created successfully!');
})
.catch(err =>{
console.error('Failed to create client:', err);
alert('Failed to create client');
});
}
function renderAdGenerator(container){
const html = `
<div id="adGeneratorSteps">
<div class="steps">
<div class="step active" id="step1">
<div class="step-number">1</div>
<div class="step-label">Client</div>
</div>
<div class="step" id="step2">
<div class="step-number">2</div>
<div class="step-label">Mode</div>
</div>
<div class="step" id="step3">
<div class="step-number">3</div>
<div class="step-label">Settings</div>
</div>
<div class="step" id="step4">
<div class="step-number">4</div>
<div class="step-label">Results</div>
</div>
</div>
<div id="adStep1" class="ad-step">
<h2 style="margin-bottom:24px;font-size:20px;font-weight:700;">Select Client</h2>
<div class="cards-grid" style="grid-template-columns:repeat(auto-fill, minmax(150px, 1fr));">
${app.clients.map(client => `
<div class="card-option" onclick="selectAdClient(this, '${client.id}')">
<div style="font-size:28px;margin-bottom:12px;">üè¢</div>
<div class="card-option-title">${client.name}</div>
</div>
`).join('')}
</div>
<div style="margin-top:32px;">
<button class="btn btn-primary" onclick="moveAdStep(2)" id="adClientNextBtn" disabled>Continue ‚Üí</button>
</div>
</div>
<div id="adStep2" class="ad-step hidden">
<h2 style="margin-bottom:24px;font-size:20px;font-weight:700;">Choose Generation Mode</h2>
<div class="cards-grid" style="grid-template-columns:repeat(auto-fill, minmax(180px, 1fr));">
<div class="card-option" onclick="selectAdMode(this, 'copy')">
<div style="font-size:32px;margin-bottom:12px;">‚úçÔ∏è</div>
<div class="card-option-title">Ad Copy</div>
<div class="card-option-desc">Generate ad headlines</div>
</div>
<div class="card-option" onclick="selectAdMode(this, 'images')">
<div style="font-size:32px;margin-bottom:12px;">üñºÔ∏è</div>
<div class="card-option-title">Image Prompts</div>
<div class="card-option-desc">Generate image ideas</div>
</div>
<div class="card-option" onclick="selectAdMode(this, 'email-sequence')">
<div style="font-size:32px;margin-bottom:12px;">üìß</div>
<div class="card-option-title">Email Sequence</div>
<div class="card-option-desc">Nurture email series</div>
</div>
<div class="card-option" onclick="selectAdMode(this, 'full')">
<div style="font-size:32px;margin-bottom:12px;">üìä</div>
<div class="card-option-title">Full Package</div>
<div class="card-option-desc">Copy + images + emails</div>
</div>
</div>
<div style="margin-top:32px;display:flex;gap:12px;">
<button class="btn btn-secondary" onclick="moveAdStep(1)">‚Üê Back</button>
<button class="btn btn-primary" onclick="moveAdStep(3)" id="adModeNextBtn" disabled>Continue ‚Üí</button>
</div>
</div>
<div id="adStep3" class="ad-step hidden">
<h2 style="margin-bottom:24px;font-size:20px;font-weight:700;">Configure Settings</h2>
<!-- Common settings -->
<div class="form-group">
<label>Platform</label>
<select id="adPlatform">
<option value="facebook">Facebook</option>
<option value="instagram">Instagram</option>
<option value="linkedin">LinkedIn</option>
<option value="tiktok">TikTok</option>
<option value="google">Google Ads</option>
</select>
</div>
<div class="form-group">
<label>Awareness Level</label>
<select id="adAwareness">
<option value="problem_aware">Problem Aware</option>
<option value="unaware">Unaware (Cold)</option>
<option value="solution_aware">Solution Aware</option>
<option value="product_aware">Product Aware</option>
<option value="most_aware">Most Aware (Hot)</option>
</select>
</div>
<div class="form-group">
<label>Target Audience</label>
<textarea id="adAudience" placeholder="Describe your target audience..."></textarea>
</div>
<div class="form-group">
<label>Offer Details</label>
<textarea id="adOffer" placeholder="What are you offering?"></textarea>
</div>
<!-- Copy-specific settings -->
<div id="adCopySettings">
<div class="two-column">
<div class="form-group">
<label>Ad Type</label>
<select id="adType">
<option value="single">Single Image</option>
<option value="carousel">Carousel</option>
<option value="video">Video</option>
<option value="story">Story</option>
</select>
</div>
<div class="form-group">
<label>Tone</label>
<select id="adTone">
<option value="conversational">Conversational</option>
<option value="professional">Professional</option>
<option value="urgent">Urgent</option>
<option value="playful">Playful</option>
<option value="authoritative">Authoritative</option>
</select>
</div>
</div>
<div class="two-column">
<div class="form-group">
<label>Hook Framework</label>
<select id="adHook">
<option value="">Auto-select best...</option>
<option value="problem-agitate-solution">PAS (Problem-Agitate-Solve)</option>
<option value="curiosity-gap">Curiosity Gap</option>
<option value="contrarian">Contrarian</option>
<option value="social-proof">Social Proof</option>
<option value="direct-benefit">Direct Benefit</option>
<option value="story-hook">Story Hook</option>
<option value="question-hook">Question Hook</option>
<option value="statistic-lead">Statistic Lead</option>
<option value="before-after">Before/After</option>
<option value="fomo">FOMO</option>
</select>
</div>
<div class="form-group">
<label>Variations</label>
<select id="adVariations">
<option value="3">3 variations</option>
<option value="5">5 variations</option>
<option value="10">10 variations</option>
</select>
</div>
</div>
</div>
<!-- Email sequence settings -->
<div id="adEmailSettings" style="display:none;">
<div class="two-column">
<div class="form-group">
<label>Sequence Type</label>
<select id="emailSeqType">
<option value="lead-nurture">Lead Nurture</option>
<option value="sales-funnel">Sales Funnel</option>
<option value="educational">Educational</option>
<option value="launch">Product Launch</option>
<option value="abandoned-cart">Abandoned Cart</option>
</select>
</div>
<div class="form-group">
<label>Number of Emails</label>
<select id="emailSeqLength">
<option value="3">3 emails</option>
<option value="5" selected>5 emails</option>
<option value="7">7 emails</option>
<option value="10">10 emails</option>
</select>
</div>
</div>
<div class="form-group">
<label>Days Between Emails</label>
<select id="emailDaysBetween">
<option value="1">Every day</option>
<option value="2" selected>Every 2 days</option>
<option value="3">Every 3 days</option>
</select>
</div>
</div>
<div class="mt-4;display:flex;gap:12px;">
<button class="btn btn-secondary" onclick="moveAdStep(2)">‚Üê Back</button>
<button class="btn btn-primary" onclick="moveAdStep(4)">Generate Ads ‚Üí</button>
</div>
</div>
<div id="adStep4" class="ad-step hidden">
<h2 style="margin-bottom:24px;font-size:20px;font-weight:700;">Generated Ads</h2>
<div id="adResults" style="display:flex;flex-direction:column;gap:16px;">
<div style="background-color:#f9fafb;border:1px dashed #e5e7eb;border-radius:8px;padding:32px;text-align:center;color:#6b7280;">
Click Generate to see results
</div>
</div>
<div style="margin-top:32px;display:flex;gap:12px;">
<button class="btn btn-secondary" onclick="moveAdStep(3)">‚Üê Back</button>
<button class="btn btn-primary" onclick="generateAds()">Generate Ads</button>
</div>
</div>
</div>
`;
container.innerHTML = html;
}
function selectAdClient(element, clientId){
document.querySelectorAll('#adStep1 .card-option').forEach(el => el.classList.remove('selected'));
element.classList.add('selected');
document.getElementById('adClientNextBtn').disabled = false;
app.currentClient = clientId;
}
function selectAdMode(element, mode){
document.querySelectorAll('#adStep2 .card-option').forEach(el => el.classList.remove('selected'));
element.classList.add('selected');
document.getElementById('adModeNextBtn').disabled = false;
app.selectedAdMode = mode;
// Show/hide mode-specific settings
const copySettings = document.getElementById('adCopySettings');
const emailSettings = document.getElementById('adEmailSettings');
if (copySettings) copySettings.style.display = (mode === 'copy' || mode === 'images' || mode === 'full') ? 'block' : 'none';
if (emailSettings) emailSettings.style.display = (mode === 'email-sequence' || mode === 'full') ? 'block' : 'none';
}
function moveAdStep(stepNumber){
for (let i = 1;i <= 4;i++){
const step = document.getElementById(`adStep${i}`);
const stepIndicator = document.getElementById(`step${i}`);
if (step){
if (i === stepNumber){
step.classList.remove('hidden');
stepIndicator.classList.add('active');
if (i > 1){
for (let j = 1;j < i;j++){
document.getElementById(`step${j}`).classList.add('completed');
}
}
}else{
step.classList.add('hidden');
stepIndicator.classList.remove('active');
}
}
}
}
// ============================================================
// NANO BANANA PRO - AI IMAGE GENERATION
// ============================================================
async function generateNanoBananaImage(promptId, btn) {
  const promptText = document.getElementById(promptId + '-text')?.textContent || '';
  const resultDiv = document.getElementById(promptId + '-result');
  if (!promptText || !resultDiv) return;

  // Update button state
  const originalHTML = btn.innerHTML;
  btn.disabled = true;
  btn.style.opacity = '0.7';
  btn.innerHTML = `<div class="loading" style="width:14px;height:14px;border-width:2px;margin:0;"></div> Generating...`;

  // Show loading in result area
  resultDiv.style.display = 'block';
  resultDiv.innerHTML = `
    <div style="text-align:center;padding:40px 20px;background:#faf5ff;border-radius:8px;border:1px dashed #c4b5fd;">
      <div class="loading" style="margin:0 auto 12px;"></div>
      <div style="font-size:13px;color:#7c3aed;font-weight:500;">Generating with Nano Banana Pro...</div>
      <div style="font-size:11px;color:#9ca3af;margin-top:4px;">This may take 10-30 seconds</div>
    </div>`;

  try {
    const response = await fetch('/api/generate-image', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        prompt: promptText,
        aspect_ratio: document.getElementById('adAspectRatio')?.value || '4:5'
      })
    });

    const data = await response.json();

    if (data.success && data.image) {
      const imgSrc = `data:${data.image.mimeType};base64,${data.image.data}`;
      resultDiv.innerHTML = `
        <div style="position:relative;border-radius:8px;overflow:hidden;border:1px solid #e5e7eb;">
          <img src="${imgSrc}" style="width:100%;display:block;border-radius:8px;" alt="Generated ad image" />
          <div style="position:absolute;top:8px;right:8px;display:flex;gap:6px;">
            <button onclick="downloadGeneratedImage(this.closest('div').previousElementSibling || this.closest('div').querySelector('img'), '${promptId}')" style="padding:6px 12px;background:rgba(0,0,0,0.7);color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;backdrop-filter:blur(4px);">
              Download
            </button>
            <button onclick="generateNanoBananaImage('${promptId}', document.querySelector('[onclick*=\\'${promptId}\\']'))" style="padding:6px 12px;background:rgba(124,58,237,0.9);color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;backdrop-filter:blur(4px);">
              Regenerate
            </button>
          </div>
        </div>
        <div style="margin-top:6px;display:flex;justify-content:space-between;align-items:center;">
          <span style="font-size:11px;color:#9ca3af;">Generated by Nano Banana Pro (Gemini)</span>
        </div>`;

      // Reset button to show "Regenerate" state
      btn.innerHTML = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg> Regenerate`;
      btn.style.background = 'linear-gradient(135deg,#6d28d9,#4c1d95)';
    } else {
      resultDiv.innerHTML = `
        <div style="padding:16px;background:#fef2f2;border-radius:8px;border:1px solid #fecaca;">
          <div style="font-size:13px;color:#dc2626;font-weight:600;margin-bottom:4px;">Image generation failed</div>
          <div style="font-size:12px;color:#991b1b;">${data.error || data.message || 'Unknown error'}</div>
        </div>`;
      btn.innerHTML = originalHTML;
    }
  } catch (err) {
    resultDiv.innerHTML = `
      <div style="padding:16px;background:#fef2f2;border-radius:8px;border:1px solid #fecaca;">
        <div style="font-size:13px;color:#dc2626;font-weight:600;margin-bottom:4px;">Connection error</div>
        <div style="font-size:12px;color:#991b1b;">${err.message}</div>
      </div>`;
    btn.innerHTML = originalHTML;
  }

  btn.disabled = false;
  btn.style.opacity = '1';
}

function downloadGeneratedImage(imgEl, name) {
  // Find the img element
  const img = imgEl.tagName === 'IMG' ? imgEl : imgEl.parentElement.querySelector('img');
  if (!img) return;
  const a = document.createElement('a');
  a.href = img.src;
  a.download = `runads-${name || 'image'}-${Date.now()}.png`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

function generateAds(){
const resultDiv = document.getElementById('adResults');
resultDiv.innerHTML = '<div class="loading" style="margin:32px auto;"></div><div style="text-align:center;color:#6b7280;margin-top:12px;">Generating with psychological triggers...</div>';
const mode = app.selectedAdMode === 'campaign' ? 'full' : app.selectedAdMode;
const payload = {
  mode: mode,
  client_data: app.clients.find(c => c.id === app.currentClient) || {},
  platform: document.getElementById('adPlatform')?.value || 'facebook',
  awareness_level: document.getElementById('adAwareness')?.value || 'problem_aware',
  target_audience: document.getElementById('adAudience')?.value,
  offer_details: document.getElementById('adOffer')?.value,
  ad_type: document.getElementById('adType')?.value,
  tone: document.getElementById('adTone')?.value,
  hook_framework: document.getElementById('adHook')?.value,
  num_variations: parseInt(document.getElementById('adVariations')?.value || '3'),
  sequence_type: document.getElementById('emailSeqType')?.value,
  sequence_length: parseInt(document.getElementById('emailSeqLength')?.value || '5'),
  days_between: parseInt(document.getElementById('emailDaysBetween')?.value || '2')
};
fetch('/api/ads',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify(payload)
})
.then(res => res.json())
.then(data =>{
resultDiv.innerHTML = '';
// Show triggers used
if (data.triggers_used && data.triggers_used.length > 0) {
  const triggerBadges = data.triggers_used.map(t =>
    `<span style="display:inline-block;padding:4px 10px;background:#f3e8ff;color:#7c3aed;border-radius:12px;font-size:12px;font-weight:600;margin:2px;">${t.name}</span>`
  ).join('');
  resultDiv.innerHTML += `<div style="margin-bottom:16px;"><span style="font-size:13px;color:#6b7280;margin-right:8px;">Triggers Applied:</span>${triggerBadges}</div>`;
}
// Show platform info
if (data.platform_optimization) {
  resultDiv.innerHTML += `<div style="margin-bottom:16px;padding:8px 12px;background:#f0f9ff;border-radius:6px;font-size:12px;color:#0369a1;">Platform: ${data.platform_optimization.platform} | Cost: $${data.estimated_cost || '0.00'} | Tokens: ${data.tokens_used || 0}</div>`;
}
// Render ad copy variations
if (data.ad_copy?.variations?.length > 0) {
  resultDiv.innerHTML += '<h3 style="font-size:16px;font-weight:700;margin:16px 0 12px;">Ad Copy Variations</h3>';
  data.ad_copy.variations.forEach((ad, i) => {
    resultDiv.innerHTML += `
    <div style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:20px;margin-bottom:12px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <span style="font-weight:700;font-size:14px;">Variation ${i+1}</span>
        <div style="display:flex;gap:6px;">
          ${(ad.triggers_used||[]).map(t => `<span style="padding:2px 8px;background:#fef3c7;color:#92400e;border-radius:8px;font-size:11px;">${t}</span>`).join('')}
        </div>
      </div>
      <div style="background:#fefce8;padding:10px 14px;border-radius:6px;font-weight:600;margin-bottom:10px;font-size:15px;">${ad.hook||''}</div>
      <div style="white-space:pre-wrap;font-size:14px;line-height:1.6;margin-bottom:12px;color:#374151;">${ad.primary_text||''}</div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;padding-top:12px;border-top:1px solid #f3f4f6;">
        <div><div style="font-size:11px;color:#6b7280;text-transform:uppercase;">Headline</div><div style="font-weight:600;font-size:13px;">${ad.headline||''}</div></div>
        <div><div style="font-size:11px;color:#6b7280;text-transform:uppercase;">Description</div><div style="font-size:13px;">${ad.description||''}</div></div>
        <div><div style="font-size:11px;color:#6b7280;text-transform:uppercase;">CTA</div><div style="font-weight:600;color:#2563eb;font-size:13px;">${ad.cta||''}</div></div>
      </div>
    </div>`;
  });
}
// Render image prompts
if (data.image_prompts?.prompts?.length > 0) {
  resultDiv.innerHTML += '<h3 style="font-size:16px;font-weight:700;margin:16px 0 12px;">Image Prompts</h3>';
  data.image_prompts.prompts.forEach((p, i) => {
    const promptId = `img-prompt-${i}`;
    resultDiv.innerHTML += `
    <div style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:20px;margin-bottom:12px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <div style="font-weight:700;">${p.concept||''}</div>
        <button onclick="generateNanoBananaImage('${promptId}', this)" style="padding:8px 16px;background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:6px;transition:all 0.2s;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="m21 15-5-5L5 21"/></svg>
          Generate Image
        </button>
      </div>
      <div style="font-size:13px;color:#374151;background:#f9fafb;padding:12px;border-radius:6px;margin-bottom:8px;font-family:monospace;" id="${promptId}-text">${p.prompt||''}</div>
      <div style="font-size:12px;color:#6b7280;font-style:italic;margin-bottom:8px;">${p.rationale||''}</div>
      <div id="${promptId}-result" style="display:none;margin-top:12px;"></div>
    </div>`;
  });
}
// Render email sequence
if (data.email_sequence?.sequence?.length > 0) {
  resultDiv.innerHTML += '<h3 style="font-size:16px;font-weight:700;margin:16px 0 12px;">Email Sequence</h3>';
  if (data.email_sequence.strategy) {
    resultDiv.innerHTML += `<div style="padding:12px;background:#f0fdf4;border-radius:8px;font-size:13px;color:#166534;margin-bottom:12px;">${data.email_sequence.strategy}</div>`;
  }
  data.email_sequence.sequence.forEach(email => {
    resultDiv.innerHTML += `
    <div style="background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:20px;margin-bottom:12px;position:relative;">
      <div style="position:absolute;top:12px;right:16px;padding:4px 10px;background:#dbeafe;color:#1e40af;border-radius:12px;font-size:11px;font-weight:600;">Day ${email.send_day}</div>
      <div style="font-size:12px;color:#6b7280;margin-bottom:4px;">Email ${email.email_number} ¬∑ ${email.awareness_level || ''}</div>
      <div style="font-weight:700;font-size:15px;margin-bottom:4px;">${email.subject_line||''}</div>
      <div style="font-size:12px;color:#9ca3af;margin-bottom:12px;">${email.preview_text||''}</div>
      <div style="white-space:pre-wrap;font-size:13px;line-height:1.6;color:#374151;max-height:200px;overflow-y:auto;padding:12px;background:#f9fafb;border-radius:6px;">${email.body||''}</div>
      <div style="margin-top:10px;display:flex;justify-content:space-between;align-items:center;">
        <span style="font-weight:600;color:#2563eb;font-size:13px;">${email.cta_text||''}</span>
        <div style="display:flex;gap:4px;">${(email.triggers_used||[]).map(t => `<span style="padding:2px 6px;background:#fef3c7;color:#92400e;border-radius:6px;font-size:10px;">${t}</span>`).join('')}</div>
      </div>
    </div>`;
  });
  if (data.email_sequence.expected_metrics) {
    const m = data.email_sequence.expected_metrics;
    resultDiv.innerHTML += `
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px;">
      <div style="text-align:center;padding:16px;background:#f9fafb;border-radius:8px;"><div style="font-size:1.5rem;font-weight:800;color:#10b981;">${m.estimated_open_rate||'--'}</div><div style="font-size:12px;color:#6b7280;">Est. Open Rate</div></div>
      <div style="text-align:center;padding:16px;background:#f9fafb;border-radius:8px;"><div style="font-size:1.5rem;font-weight:800;color:#2563eb;">${m.estimated_click_rate||'--'}</div><div style="font-size:12px;color:#6b7280;">Est. Click Rate</div></div>
      <div style="text-align:center;padding:16px;background:#f9fafb;border-radius:8px;"><div style="font-size:1.5rem;font-weight:800;color:#7c3aed;">${m.optimal_send_time||'--'}</div><div style="font-size:12px;color:#6b7280;">Best Send Time</div></div>
    </div>`;
  }
}
// No results at all
if (!data.ad_copy?.variations?.length && !data.image_prompts?.prompts?.length && !data.email_sequence?.sequence?.length) {
  resultDiv.innerHTML += '<div style="color:#6b7280;text-align:center;padding:32px;">No results generated. Try again.</div>';
}
})
.catch(err =>{
console.error('Failed to generate ads:', err);
resultDiv.innerHTML = '<div style="color:#ef4444;text-align:center;padding:32px;">Failed to generate: ' + err.message + '</div>';
});
}
function renderReports(container){
const html = `
<div style="background-color:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;">
<h2 style="font-size:20px;font-weight:700;margin-bottom:24px;">Performance Reports</h2>
<div class="stats-grid">
<div class="stat-card">
<div class="stat-label">Total Revenue</div>
<div class="stat-value">$24,500</div>
<div class="stat-change">+23% vs last month</div>
</div>
<div class="stat-card">
<div class="stat-label">Conversion Rate</div>
<div class="stat-value">4.2%</div>
<div class="stat-change">+0.8% vs last month</div>
</div>
<div class="stat-card">
<div class="stat-label">Cost Per Lead</div>
<div class="stat-value">$12.50</div>
<div class="stat-change">-$2 vs last month</div>
</div>
<div class="stat-card">
<div class="stat-label">ROI</div>
<div class="stat-value">340%</div>
<div class="stat-change">+45% vs last month</div>
</div>
</div>
<h3 style="font-size:16px;font-weight:700;margin-top:32px;margin-bottom:16px;">Top Performing Pages</h3>
<div class="table-container">
<table>
<thead>
<tr>
<th>Page</th>
<th>Views</th>
<th>Leads</th>
<th>Conv. Rate</th>
<th>Revenue</th>
</tr>
</thead>
<tbody>
${app.pages.slice(0, 5).map(page =>{
const conv = page.views > 0 ? ((page.leads / page.views) * 100).toFixed(1):'0';
return `
<tr>
<td><strong>${page.name}</strong></td>
<td>${page.views || 0}</td>
<td>${page.leads || 0}</td>
<td>${conv}%</td>
<td>$${(Math.random() * 10000).toFixed(2)}</td>
</tr>
`;
}).join('')}
</tbody>
</table>
</div>
</div>
`;
container.innerHTML = html;
}
function renderLeads(container, headerActions){
const html = `
<div style="margin-bottom:24px;display:flex;gap:12px;">
<select id="leadsFilter" style="padding:10px 12px;border:1px solid #e5e7eb;border-radius:8px;font-size:14px;">
<option value="">All Pages</option>
${app.pages.map(page => `<option value="${page.id}">${page.name}</option>`).join('')}
</select>
<button class="btn btn-secondary" onclick="exportLeads()">üì• Export CSV</button>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>Date</th>
<th>Page</th>
<th>Name</th>
<th>Email</th>
<th>Phone</th>
<th>UTM Source</th>
</tr>
</thead>
<tbody id="leadsTable">
</tbody>
</table>
</div>
`;
container.innerHTML = html;
loadLeadsTable();
}
function loadLeadsTable(){
fetch('/api/leads')
.then(res => res.json())
.then(data =>{
const tbody = document.getElementById('leadsTable');
tbody.innerHTML = '';
if (!data.leads || data.leads.length === 0){
tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:32px;color:#6b7280;">No leads yet</td></tr>';
return;
}
data.leads.forEach(lead =>{
const row = document.createElement('tr');
row.innerHTML = `
<td style="font-size:13px;color:#6b7280;">${new Date(lead.createdAt).toLocaleDateString()}</td>
<td>${lead.pageName || '‚Äî'}</td>
<td><strong>${lead.name}</strong></td>
<td style="font-size:13px;color:#2563eb;">${lead.email}</td>
<td style="font-size:13px;">${lead.phone || '‚Äî'}</td>
<td style="font-size:13px;color:#6b7280;">${lead.utmSource || '‚Äî'}</td>
`;
tbody.appendChild(row);
});
})
.catch(err => console.error('Failed to load leads:', err));
}
function exportLeads(){
window.location.href = '/api/leads/export';
}
function editPage(pageId){
openHtmlEditor(pageId);
}
function openHtmlEditor(pageId){
const page = app.pages.find(p => p.id === pageId);
if (!page) return;
app.currentPage = page;
const editor = document.getElementById('htmlEditorCode');
const preview = document.getElementById('htmlEditorPreview');
fetch(`/api/pages/${pageId}`)
.then(res => res.json())
.then(data =>{
editor.value = data.html || '';
updatePreview();
openModal('editPageModal');
})
.catch(err => console.error('Failed to load page:', err));
editor.addEventListener('input', updatePreview);
}
function updatePreview(){
const code = document.getElementById('htmlEditorCode').value;
const preview = document.getElementById('htmlEditorPreview');
try{
preview.srcdoc = code;
}catch (err){
console.error('Failed to update preview:', err);
}
}
function savePage(){
const html = document.getElementById('htmlEditorCode').value;
const pageId = app.currentPage.id;
fetch(`/api/pages/${pageId}`,{
method:'PUT',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({html})
})
.then(res => res.json())
.then(data =>{
deployPage(pageId);
})
.catch(err => console.error('Failed to save page:', err));
}
function generateVariants(pageId){
const page = app.pages.find(p => p.id === pageId);
if (!page) return alert('Page not found');
if (!confirm(`Generate A/B variants for "${page.name}"?\n\nThis will create 3 variants:\n- Alternate Layout\n- Dark Theme\n- Urgency Focused`)) return;
fetch(`/api/variants/${pageId}/generate`, {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({ variant_types: ['alternate-layout', 'dark-theme', 'urgency-focused'] })
})
.then(res => res.json())
.then(data => {
  if (data.success) {
    alert(`Created ${data.variants_created} variants for "${page.name}"!`);
    loadPages();
  } else {
    alert('Failed: ' + (data.error || 'Unknown error'));
  }
})
.catch(err => alert('Error: ' + err.message));
}
function viewPageAnalytics(pageId){
app.currentPage = app.pages.find(p => p.id === pageId);
openModal('pageAnalyticsModal');
loadPageAnalytics(pageId);
}
function loadPageAnalytics(pageId){
fetch(`/api/pages/${pageId}/analytics`)
.then(res => res.json())
.then(data =>{
renderAnalyticsCharts(data);
})
.catch(err => console.error('Failed to load analytics:', err));
}
function renderAnalyticsCharts(data){
const viewsChart = document.getElementById('viewsChart');
viewsChart.innerHTML = '';
const viewsData = data.dailyViews || [45, 52, 48, 61, 55, 67, 72];
const maxViews = Math.max(...viewsData);
viewsData.forEach((value, i) =>{
const item = document.createElement('div');
item.className = 'chart-bar-item';
item.innerHTML = `
<div class="chart-bar-value" style="height:${(value / maxViews) * 180}px;" title="${value}"></div>
<div class="chart-bar-label">Day ${i + 1}</div>
`;
viewsChart.appendChild(item);
});
const leadsChart = document.getElementById('leadsChart');
leadsChart.innerHTML = '';
const leadsData = data.dailyLeads || [5, 8, 6, 12, 9, 15, 18];
const maxLeads = Math.max(...leadsData);
leadsData.forEach((value, i) =>{
const item = document.createElement('div');
item.className = 'chart-bar-item';
item.innerHTML = `
<div class="chart-bar-value" style="height:${(value / maxLeads) * 180}px;background-color:#10b981;" title="${value}"></div>
<div class="chart-bar-label">Day ${i + 1}</div>
`;
leadsChart.appendChild(item);
});
const trafficTable = document.getElementById('trafficSourcesTable');
const sources = data.trafficSources || [
{name:'Google Ads', visits:1250},
{name:'Facebook', visits:980},
{name:'Direct', visits:450}
];
trafficTable.innerHTML = sources.map(s => `
<tr><td style="padding:8px 0;">${s.name}</td><td style="text-align:right;padding:8px 0;">${s.visits}</td></tr>
`).join('');
}
function setAnalyticsPeriod(period){
loadPageAnalytics(app.currentPage.id);
}
function deletePage(pageId){
if (!confirm('Are you sure you want to delete this page?')) return;
fetch(`/api/pages/${pageId}`,{method:'DELETE'})
.then(res => res.json())
.then(data =>{
loadPages();
renderDashboard(document.getElementById('contentArea'), document.getElementById('headerActions'));
alert('Page deleted');
})
.catch(err => console.error('Failed to delete page:', err));
}
function deleteClient(clientId){
if (!confirm('Are you sure you want to delete this client?')) return;
fetch(`/api/clients/${clientId}`,{method:'DELETE'})
.then(res => res.json())
.then(data =>{
loadClients();
loadClientsForSelects();
renderAllClients(document.getElementById('contentArea'), document.getElementById('headerActions'));
alert('Client deleted');
})
.catch(err => console.error('Failed to delete client:', err));
}
function deployPage(pageId){
fetch(`/api/pages/${pageId}/deploy`,{method:'POST'})
.then(res => res.json())
.then(data =>{
closeModal('editPageModal');
loadPages();
renderDashboard(document.getElementById('contentArea'), document.getElementById('headerActions'));
alert('Page saved and deployed!');
})
.catch(err => console.error('Failed to deploy page:', err));
}
function selectPageType(element, type){
document.querySelectorAll('.card-option').forEach(el => el.classList.remove('selected'));
element.classList.add('selected');
app.selectedPageType = type;
}
// 7-Step Pipeline Generation
const PIPELINE_STEPS = ['research', 'brand', 'strategy', 'copy', 'design', 'factcheck', 'assembly'];
let currentJobId = null;
let pipelineRunning = false;

function generatePage(){
if (!app.selectedPageType){
alert('Please select a page type');
return;
}
const btn = document.getElementById('generatePageBtn');
btn.disabled = true;
btn.style.display = 'none';
document.getElementById('pipelineProgress').style.display = 'block';

const payload = {
pageType: app.selectedPageType,
url: document.getElementById('generatePageUrl').value,
audience: document.getElementById('generatePageAudience').value,
tone: document.getElementById('generatePageTone').value,
clientId: document.getElementById('generatePageClient').value || null
};

// Reset pipeline UI
resetPipelineUI();
pipelineRunning = true;

// Start the pipeline
fetch('/api/pipeline/start', {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify(payload)
})
.then(res => res.json())
.then(data => {
if (!data.success || !data.jobId) {
throw new Error(data.error || 'Failed to start pipeline');
}
currentJobId = data.jobId;
// Run steps sequentially
runPipelineSteps(data.jobId, payload);
})
.catch(err => {
console.error('Pipeline start failed:', err);
pipelineRunning = false;
btn.disabled = false;
btn.style.display = '';
document.getElementById('pipelineProgress').style.display = 'none';
alert('Failed to start generation: ' + err.message);
});
}

async function runPipelineSteps(jobId, payload) {
let totalTokens = 0;
for (let i = 0; i < PIPELINE_STEPS.length; i++) {
if (!pipelineRunning) return;
const step = PIPELINE_STEPS[i];
updateStepUI(step, 'running');
updatePipelineProgress((i / PIPELINE_STEPS.length) * 100, `Running: ${getStepLabel(step)}...`);

try {
const resp = await fetch(`/api/pipeline/${jobId}/step/${step}`, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({ url: payload.url, productName: payload.productName })
});
const result = await resp.json();
if (!result.success) throw new Error(result.error || `Step ${step} failed`);
totalTokens += (result.tokensUsed || 0);
updateStepUI(step, 'complete');
updatePipelineProgress(((i + 1) / PIPELINE_STEPS.length) * 100, `Completed: ${getStepLabel(step)}`);
document.getElementById('pipelineCost').textContent = `Tokens: ${totalTokens.toLocaleString()} | Est. cost: $${((totalTokens / 1000000) * 9).toFixed(4)}`;

// If assembly is done, show success
if (step === 'assembly' && result.data) {
pipelineComplete(result.data);
}
} catch (err) {
console.error(`Step ${step} failed:`, err);
updateStepUI(step, 'failed');
updatePipelineProgress(0, `Failed at: ${getStepLabel(step)} - ${err.message}`);
pipelineRunning = false;
document.getElementById('generatePageBtn').disabled = false;
document.getElementById('generatePageBtn').style.display = '';
document.getElementById('generatePageBtn').innerHTML = '<span>Retry</span>';
return;
}
}
}

function pipelineComplete(assemblyData) {
pipelineRunning = false;
updatePipelineProgress(100, 'Generation complete!');
document.getElementById('pipelineStatus').innerHTML = `<strong style="color:#16a34a;">Page generated successfully!</strong>`;
loadPages();
loadStats();
setTimeout(() => {
closeModal('generatePageModal');
document.getElementById('generatePageBtn').disabled = false;
document.getElementById('generatePageBtn').style.display = '';
document.getElementById('generatePageBtn').innerHTML = '<span>Generate Page</span>';
document.getElementById('pipelineProgress').style.display = 'none';
resetPipelineUI();
}, 2000);
}

function resetPipelineUI() {
PIPELINE_STEPS.forEach(step => updateStepUI(step, 'waiting'));
document.getElementById('pipelineProgressFill').style.width = '0%';
document.getElementById('pipelineStatus').textContent = '';
document.getElementById('pipelineCost').textContent = '';
}

function updateStepUI(step, status) {
const el = document.querySelector(`.pipeline-step[data-step="${step}"]`);
if (!el) return;
const statusEl = el.querySelector('.step-status');
el.style.opacity = status === 'waiting' ? '0.5' : '1';
el.style.background = status === 'running' ? '#eff6ff' : status === 'complete' ? '#f0fdf4' : status === 'failed' ? '#fef2f2' : 'transparent';
el.style.borderRadius = '8px';
el.style.padding = '8px 12px';
if (status === 'waiting') statusEl.textContent = 'Waiting';
else if (status === 'running') { statusEl.innerHTML = '<span class="loading" style="width:14px;height:14px;"></span> Running'; statusEl.style.color = '#2563eb'; }
else if (status === 'complete') { statusEl.textContent = '‚úì Done'; statusEl.style.color = '#16a34a'; }
else if (status === 'failed') { statusEl.textContent = '‚úó Failed'; statusEl.style.color = '#dc2626'; }
}

function updatePipelineProgress(percent, statusText) {
document.getElementById('pipelineProgressFill').style.width = percent + '%';
if (statusText) document.getElementById('pipelineStatus').textContent = statusText;
}

function getStepLabel(step) {
const labels = {
research: 'Deep Research', brand: 'Brand Extraction', strategy: 'Page Strategy',
copy: 'Copy Generation', design: 'Design Generation', factcheck: 'Fact Checking', assembly: 'Final Assembly'
};
return labels[step] || step;
}
function importHtml(){
const pageName = document.getElementById('importPageName').value;
const clientId = document.getElementById('importClient').value;
const htmlCode = document.getElementById('importHtmlCode').value;
if (!pageName){
alert('Page name is required');
return;
}
if (!htmlCode){
alert('HTML code is required');
return;
}
fetch('/api/pages',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
name:pageName,
clientId:clientId || null,
html:htmlCode
})
})
.then(res => res.json())
.then(data =>{
closeModal('importHtmlModal');
loadPages();
if (data.id){
deployPage(data.id);
}
alert('Page imported and deployed!');
})
.catch(err =>{
console.error('Failed to import page:', err);
alert('Failed to import page');
});
}
function saveBrandGuide(clientId){
const brandGuide ={
primaryColor:document.getElementById('colorPrimary').value,
secondaryColor:document.getElementById('colorSecondary').value,
accentColor:document.getElementById('colorAccent').value
};
fetch(`/api/clients/${clientId}/style-guide`,{
method:'PUT',
headers:{'Content-Type':'application/json'},
body:JSON.stringify(brandGuide)
})
.then(res => res.json())
.then(data =>{
alert('Brand guide saved!');
})
.catch(err => console.error('Failed to save brand guide:', err));
}
function toggleChatPanel(){
document.getElementById('chatPanel').classList.toggle('active');
}
function sendChatMessage(){
const input = document.getElementById('chatInput');
const message = input.value.trim();
if (!message) return;
const messagesDiv = document.getElementById('chatMessages');
const userMsg = document.createElement('div');
userMsg.className = 'chat-message user';
userMsg.innerHTML = `<div class="chat-message-bubble">${message}</div>`;
messagesDiv.appendChild(userMsg);
messagesDiv.scrollTop = messagesDiv.scrollHeight;
input.value = '';
fetch('/api/chat',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
message,
pageId:app.currentPage?.id,
context:document.getElementById('htmlEditorCode')?.value
})
})
.then(res => res.json())
.then(data =>{
const assistantMsg = document.createElement('div');
assistantMsg.className = 'chat-message assistant';
assistantMsg.innerHTML = `<div class="chat-message-bubble">${data.response}</div>`;
messagesDiv.appendChild(assistantMsg);
messagesDiv.scrollTop = messagesDiv.scrollHeight;
})
.catch(err => console.error('Failed to send message:', err));
}
function openModal(modalId){
document.getElementById(modalId).classList.add('active');
}
function closeModal(modalId){
document.getElementById(modalId).classList.remove('active');
document.querySelectorAll(`#${modalId}input[type="text"], #${modalId}textarea, #${modalId}select`).forEach(el =>{
el.value = '';
});
document.querySelectorAll(`#${modalId}.card-option`).forEach(el =>{
el.classList.remove('selected');
});
}
function copyToClipboard(text){
navigator.clipboard.writeText(text).then(() =>{
alert('Copied to clipboard!');
});
}
function exportAd(index){
alert(`Ad #${index + 1}exported`);
}
document.querySelectorAll('.modal-overlay').forEach(overlay =>{
overlay.addEventListener('click', (e) =>{
if (e.target === overlay){
overlay.classList.remove('active');
}
});
});
</script>
</body>
</html>